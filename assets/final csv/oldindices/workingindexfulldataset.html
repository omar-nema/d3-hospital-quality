<!DOCTYPE html>
<meta charset="utf-8">
<style>


.axis text{
   font: 12px monospace;
}
.chart text{
   font: 8px monospace;
}
 .secondman {
  font: 80px monospace;
  transform: rotate(-90deg);
}

.axis path,
.axis line {
  fill: none;
/*  stroke: #000;*/
  stroke: lightgrey;
  stroke-width: 4px;
  shape-rendering: crispEdges;

}

/*.axis line2 {
  fill: none;
  stroke: blue;
  shape-rendering: crispEdges;

}*/

.x.axis path {        
  display: none;
}

/*div.tooltip { 
    position: absolute;     
    text-align: center;     
    width: 80px;          
    height: 28px;         
    padding: 2px;       
    font: 8px monospace;    
    background: lightsteelblue; 
    border: 0px;    
    border-radius: 8px;     
    pointer-events: none;     
}*/



</style>
<head>
</head>
<body>
<svg class="chart">

</svg>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script src="../colorbrewer.js"></script>
<script>

  var margin = {top: 20, right: 40, bottom: 30, left: 40},
    width = 800 - margin.left - margin.right,
    height = 400 - margin.top- - margin.bottom;

  var ycost = d3.scale.linear().range([height, 0]);
  var yincome = d3.scale.linear().range([height, 0]);
  var yquality = d3.scale.linear().range([height, 0]);
  var ydischarge = d3.scale.linear().range([height, 0]);
  var yaxiscost = d3.svg.axis().scale(ycost).orient("left").tickSize(0);
  var yaxisincome = d3.svg.axis().scale(yquality).orient("left").tickSize(0).tickValues([]);
  var yaxisquality = d3.svg.axis().scale(ydischarge).orient("left").tickSize(0).tickValues([]);
  var yaxisdischarge = d3.svg.axis().scale(yincome).orient("left").tickSize(0).tickValues([]);


  // Define the div for the tooltip
  var div = d3.select("body").append("div") 
      .attr("class", "tooltip")       
      .style("opacity", 0);
  var div2 = d3.select("body").append("div") 
      .attr("class", "tooltip2")       
      .style("opacity", 0);

  var chart = d3.select(".chart")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  d3.csv('OUTPATIENT.csv',function(data){

          ycost.domain([0, 1]);
          yincome.domain([0, 1]);
          yquality.domain([0, 1]);
          ydischarge.domain([0, 1]);

      //break up columns into variables, combine into alldata , PRESCALE
        var cost, income, quality, discharge;
        cost = [];
       // costval = [];
        income = [];
      //  incomeval = [];
        quality = [];
        discharge = [];

        // data = data.sort(function(a,b){return d3.descending(+a.income, +b.income)});
        // data = data.filter(function(d,i){return i<100});

        var provMap = {};
        data.forEach(function(d,i){
            provMap[i] = d.provider;
        });

        data.map(function(d){    
          cost.push(ycost(+d.cost));
         // costval.push(+d.costval);
          income.push(yincome(+d.income));
          quality.push(yquality(+d.quality));
          //colors.push(d.colors);
          return discharge.push(ydischarge(+d.discharge));
        }); 

      // var alldata2 =  [discharge, cost, income, quality];
         var alldata2 =  [discharge, quality, income, cost];

      //put things in array for for loop
      var x1 = 0;
      var x2 = width/4 ;
      var x3 = width/2 ;
      var x4 = width*3/4 ;
      var xvalues = [0, x2, x3, x4];

      //array created for scales, axes so that correct object is applied in for loop

      //var scales = [ycost, yincome, yquality, ydischarge];
      //var scales = [ydischarge, yincome, yquality, ycost];
     // var scales = [ydischarge, yquality, yincome, ycost];

      var yaxes = [yaxiscost, yaxisincome, yaxisquality, yaxisdischarge];

      //result var created 
      var result = [];

      //for LINE  
      //below getting y values (rows) of data to create lines
      function transpose(a) {
          return Object.keys(a[0]).map(
              function (c) { return a.map(function (r) { return r[c]; }); }
              );
          }
        var yvalrows = transpose(alldata2);
        var numRows =  yvalrows.length;
        var numColumns = alldata2.length;

      var colorscale = d3.scale.linear()
          .domain([0, numRows])
         .range(["red","blue"]);
         //how to order this gradient


        //create 2d array for line x values
        var xvalrows = [];
            for (j = 0; j < numRows; j++) { 
                xvalrows.push(xvalues);
            }        
    
      //ay u want circles?
      alldata2.forEach(function(d, i) {
          //i from 0 to 3, for each axis
          //declare variables that differ for each axis (like bubble size, y values)
          chart.append('g').attr('class', 'y axis').call(yaxes[i]).attr("transform", "translate(" + xvalues[i] + ",0)");


    }); //(ay u like dem circles)

        //ay u want lines?
        yvalrows.forEach(function(d, i){ //for each row, create a line

                  var currcolor = colorscale(i);
                  var currxvalrows = xvalrows[i];
                  var curryvalrows = yvalrows[i];
                  var currdata = [currxvalrows, curryvalrows];
                  var currTrans = transpose(currdata);

                  var line = d3.svg.line()
                        .x(function(d, i) {
                            return d[0]; //formatted as 4 col, x row array
                        })
                        .y(function(d, i) {
                            return d[1];
                        })
                        .interpolate("linear")
// .               style("stroke", function() {
//                 return d.color = color(d.key); })
                        ;
                chart.append("polyline")
                   .style("stroke", colorscale(i)) 
                    .style("fill", "none")  
                    .style("fill", "none")  
                    // .style ('stroke-width', '1px') 
                    .style ('stroke-width', '.08px') 
                    .attr("points", currTrans)
                    .on("mouseover", function(){
                        console.log([d, provMap[i]]);
                    });  
        })
 
});

 



</script>







