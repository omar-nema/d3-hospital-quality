<!DOCTYPE html>
<meta charset="utf-8">
<style>


.axis text{
   font: 12px monospace;
}
.chart text{
   font: 8px monospace;
}
 .secondman {
  font: 80px monospace;
  transform: rotate(-90deg);
}

.axis path,
.axis line {
  fill: none;
/*  stroke: #000;*/
  stroke: lightgrey;
  stroke-width: 2px;
  shape-rendering: crispEdges;

}

/*.axis line2 {
  fill: none;
  stroke: blue;
  shape-rendering: crispEdges;

}*/

.x.axis path {        
  display: none;
}

/*div.tooltip { 
    position: absolute;     
    text-align: center;     
    width: 80px;          
    height: 28px;         
    padding: 2px;       
    font: 8px monospace;    
    background: lightsteelblue; 
    border: 0px;    
    border-radius: 8px;     
    pointer-events: none;     
}*/



</style>
<head>
</head>
<body>
<svg class="chart">

</svg>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script>

  var margin = {top: 20, right: 40, bottom: 30, left: 40},
    width = 800 - margin.left - margin.right,
    height = 400 - margin.top- - margin.bottom;

  var ycost = d3.scale.linear().range([height, 0]);
  var yincome = d3.scale.linear().range([height, 0]);
  var yquality = d3.scale.linear().range([height, 0]);
  var yinsured = d3.scale.linear().range([height, 0]);
  var yaxiscost = d3.svg.axis().scale(ycost).orient("left").tickSize(0);
  var yaxisincome = d3.svg.axis().scale(yquality).orient("left").tickSize(0).tickValues([]);
  var yaxisquality = d3.svg.axis().scale(yinsured).orient("left").tickSize(0).tickValues([]);
  var yaxisinsured = d3.svg.axis().scale(yincome).orient("left").tickSize(0).tickValues([]);
  var z = d3.scale.ordinal().range([ "#aad", "#556"]);


  // Define the div for the tooltip
  var div = d3.select("body").append("div") 
      .attr("class", "tooltip")       
      .style("opacity", 0);
  var div2 = d3.select("body").append("div") 
      .attr("class", "tooltip2")       
      .style("opacity", 0);

  var chart = d3.select(".chart")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


  d3.csv('ecgall.csv',function(data){

          ycost.domain([0, 1]);
          yincome.domain([20, 55]);
          yquality.domain([.3, .7]);
          yinsured.domain([0, 1]);

      //break up columns into variables, combine into alldata , PRESCALE
        var cost, costval, income, incomeval, quality, insured;
        cost = [];
        costval = [];
        income = [];
        incomeval = [];
        quality = [];
        insured = [];

        data.map(function(d){    
          cost.push(ycost(+d.cost));
          costval.push(+d.costval);
          income.push(yincome(+d.income));
          incomeval.push(+d.incomeval);
          quality.push(yquality(+d.quality));
          return insured.push(yinsured(+d.insured));
        }); 


      var alldata = [cost, costval, income, incomeval, quality, insured];
      var alldata2 =  [cost, income, quality, insured];

      //put things in array for for loop
      var x1 = 0;
      var x2 = width/4 ;
      var x3 = width/2 ;
      var x4 = width*3/4 ;
      var xvalues = [0, x2, x3, x4];
      var y1values = [data[0].cost, data[0].income, data[0].quality, data[0].insured];
     // var xvalues = [x1, x2, x3, x4];

      //array created for scales, axes so that correct object is applied in for loop

      var scales = [ycost, yincome, yquality, yinsured];
      var yaxes = [yaxiscost, yaxisincome, yaxisquality, yaxisinsured];

      //result var created 
      var result = [];

      //for LINE  
      //below getting y values (rows) of data to create lines
      function transpose(a) {
          return Object.keys(a[0]).map(
              function (c) { return a.map(function (r) { return r[c]; }); }
              );
          }
        var yvalrows = transpose(alldata2);
        var numRows =  yvalrows.length;
        var numColumns = alldata2.length;


        //create 2d array for line x values
        var xvalrows = [];
            for (j = 0; j < numRows; j++) { 
                xvalrows.push(xvalues);
            }        
      var size = [costval, incomeval, quality, insured];
      //console.log(size);
      var scaleFactor = [1000, 10000, 1000, 1000];
      
      //ay u want circles?
      alldata2.forEach(function(d, i) {
          //i from 0 to 3, for each axis

          var currscale = scales[i];
          var currVal = alldata2[i];
          var currsize = size[i];
          chart.append('g').attr('class', 'y axis').call(yaxes[i]).attr("transform", "translate(" + xvalues[i] + ",0)");
          
          result[i] = chart.selectAll("g.result[i]").data(alldata2[i]); //array with 1 x # rows
          result[i].exit().remove();
          d3.selectAll('chart').append('g').attr('class', 'result');


            //add y axis


          var radius = currsize[i]/scaleFactor[i];
          result[i] = chart.selectAll("g.result[i]").data(alldata2[i]); //array with 1 x # rows
          result[i].exit().remove();
  
    

          result[i].enter().append("chart:circle")
            // .transition()
            // .duration(1000)
            .attr("cx", xvalues[i])
            .attr("cy", function(d, i) { return currVal[i]; }) //can take str8 arrays! d, i based off array 
            .attr("r", function(d, i) { return raduis;});







          // var circlebuild =  result[i].selectAll('circle').data(alldata2[i]);
          // circlebuild.exit().remove();
          // circlebuild.enter().append('circle');


       // result[i].enter().append("chart:g").attr('class', 'result');
         //  result[i].enter().append("chart:g").attr('class', 'result').selectAll('circle') 

          // result[i].selectAll('circle')   
          //   // .transition()
          //   // .duration(1000)
          //   .attr("cx", xvalues[i])
          //   .attr("cy", function(d, i) { return currVal[i]; }) //can take str8 arrays! d, i based off array 
          //   .attr("r", function(d, i) { return currsize[i]/scaleFactor[i]; });


       // result[i] = chart.selectAll("g.result[i]").data(alldata2[i]); //array with 1 x # rows
          // result[i].exit().remove();
          //result[i].enter().append("chart:g").attr('class', 'result');

         // var result = chart.selectAll("g.result").data(results)
         // result.exit().remove()
         // result.enter().append("chart:g").attr('class', 'result')
         //      .style('fill', function(d, i) {return z(i);})
         //      .style('stroke', function(d, i) {return d3.rgb(z(i)).darker();})
   //    var rectbuild =        
   //    result.selectAll('rect').data(Object)

   //    rectbuild.exit().remove();
   //    rectbuild.enter().append('rect')
   //    ;







    }); //(ay u like dem circles)

        //ay u want lines?
        yvalrows.forEach(function(d, i){ //for each row, create a line

                  var currxvalrows = xvalrows[i];
                  var curryvalrows = yvalrows[i];
                  var currdata = [currxvalrows, curryvalrows];
                   // console.log(currdata);
                  var currTrans = transpose(currdata);

                  var line = d3.svg.line()
                        .x(function(d, i) {
                            return d[0]; //formatted as 4 col, x row array
                        })
                        .y(function(d, i) {
                            return d[1];
                        })
                        .interpolate("linear")
// .               style("stroke", function() {
//                 return d.color = color(d.key); })
                        ;

  
                          //poly line sort of fast

                chart.append("polyline")
                   .style("stroke", "blue") 
                    .style("fill", "none")  
                    .style("fill", "none")  
                    .style ('stroke-width', '0.04px') 
                    .attr("points", currTrans);  

        })

       
 
});

 



</script>







